<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CLIMADA Hurricane Analysis - Scientific Risk Modeling</title>
    <meta name="description" content="CLIMADA framework for scientific hurricane risk modeling with peer-reviewed methods and uncertainty quantification">
    
    <!-- Shared Styles -->
    <link rel="stylesheet" href="shared-styles.css">
    
    <!-- Mapbox GL JS -->
    <script src='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js'></script>
    <link href='https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css' rel='stylesheet' />
    
    <style>
        /* CLIMADA-specific styles */
        .app-content {
            display: flex;
            height: calc(100vh - 80px);
        }
        
        .map-section {
            flex: 1;
            position: relative;
        }
        
        #climada-map {
            width: 100%;
            height: 100%;
        }
        
        .analysis-panel {
            width: 400px;
            background: var(--surface);
            border-left: 2px solid var(--border);
            padding: 30px;
            overflow-y: auto;
        }
        
        .analysis-title {
            font-size: 18px;
            color: var(--climada-primary);
            margin-bottom: 20px;
            font-weight: 500;
        }
        
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .metric-card {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid var(--climada-primary);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }
        
        .metric-value {
            font-size: 20px;
            font-weight: 600;
            color: var(--climada-primary);
            margin-bottom: 5px;
        }
        
        .metric-label {
            font-size: 11px;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .hurricane-list {
            max-height: 300px;
            overflow-y: auto;
        }
        
        .hurricane-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.2s ease;
            border-left: 3px solid var(--climada-primary);
        }
        
        .hurricane-item:hover {
            background: rgba(33, 150, 243, 0.1);
        }
        
        .hurricane-name {
            font-weight: 500;
            color: var(--text);
            margin-bottom: 4px;
        }
        
        .hurricane-details {
            font-size: 11px;
            color: var(--text-muted);
        }
        
        .controls-left {
            top: 100px;
            left: 20px;
            width: 280px;
        }
        
        .controls-right {
            top: 100px;
            right: 20px;
            width: 250px;
        }
        
        .methodology-info {
            background: rgba(33, 150, 243, 0.1);
            border: 1px solid var(--climada-primary);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
        }
        
        .methodology-info h4 {
            color: var(--climada-primary);
            margin: 0 0 10px 0;
            font-size: 14px;
        }
        
        .methodology-info p {
            font-size: 12px;
            color: var(--text-muted);
            line-height: 1.4;
            margin: 0;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .btn {
            padding: 10px 16px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .btn-primary {
            background: var(--climada-primary);
            color: white;
        }
        
        .btn-primary:hover {
            background: var(--climada-secondary);
        }
        
        .btn-secondary {
            background: transparent;
            color: var(--climada-primary);
            border: 1px solid var(--climada-primary);
        }
        
        .btn-secondary:hover {
            background: rgba(33, 150, 243, 0.1);
        }
        
        @media (max-width: 1024px) {
            .app-content {
                flex-direction: column;
            }
            
            .analysis-panel {
                width: 100%;
                height: 300px;
                border-left: none;
                border-top: 2px solid var(--border);
            }
            
            .controls-left, .controls-right {
                position: relative;
                top: auto;
                left: auto;
                right: auto;
                width: 100%;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Standardized Header -->
    <header class="app-header">
        <div class="header-left">
            <div class="framework-logo">
                <div class="framework-icon climada">CL</div>
                <div>
                    <h1 class="app-title climada">CLIMADA Framework</h1>
                    <div class="app-subtitle">Scientific Hurricane Risk Modeling</div>
                </div>
            </div>
        </div>
        <nav class="header-nav">
            <a href="climate-os-statistical.html" class="nav-link framework climate-os">Climate-OS</a>
            <a href="cbottle-risk-assessment.html" class="nav-link framework cbottle">C-bottle</a>
            <a href="framework-comparison.html" class="nav-link secondary">Compare</a>
            <a href="index.html" class="nav-link primary">Overview</a>
        </nav>
    </header>

    <main class="app-content">
        <!-- Map Section -->
        <div class="map-section">
            <div id="climada-map"></div>
            
            <!-- Left Controls Panel -->
            <div class="control-panel controls-left">
                <h3>Hurricane Analysis</h3>
                <label>Time Period</label>
                <select id="time-period">
                    <option value="2020-2024">Recent (2020-2024)</option>
                    <option value="2010-2019">Previous Decade</option>
                    <option value="2000-2009">2000s</option>
                    <option value="1990-1999">1990s</option>
                </select>
                
                <label>Hurricane Category</label>
                <select id="category-filter">
                    <option value="all">All Categories</option>
                    <option value="major">Major (Cat 3+)</option>
                    <option value="cat5">Category 5</option>
                    <option value="cat4">Category 4</option>
                    <option value="cat3">Category 3</option>
                </select>
                
                <label>Analysis Type</label>
                <select id="analysis-type">
                    <option value="swath">Hurricane Swaths</option>
                    <option value="tracks">Storm Tracks</option>
                    <option value="intensity">Intensity Analysis</option>
                    <option value="frequency">Frequency Maps</option>
                </select>
                
                <div class="methodology-info">
                    <h4>CLIMADA Methodology</h4>
                    <p>Uses peer-reviewed probabilistic hurricane models with uncertainty quantification and validated damage functions.</p>
                </div>
            </div>
            
            <!-- Right Stats Panel -->
            <div class="stats-panel controls-right">
                <div class="stats-title">Analysis Results</div>
                <div class="stat-row">
                    <span class="stat-label">Storms Analyzed</span>
                    <span class="stat-value" id="storms-count">156</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Major Hurricanes</span>
                    <span class="stat-value" id="major-count">47</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Avg Intensity</span>
                    <span class="stat-value" id="avg-intensity">Cat 2.3</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Model Confidence</span>
                    <span class="stat-value" id="confidence">87%</span>
                </div>
                <div class="stat-row">
                    <span class="stat-label">Data Quality</span>
                    <span class="stat-value" id="data-quality">High</span>
                </div>
            </div>
        </div>
        
        <!-- Analysis Panel -->
        <div class="analysis-panel">
            <h2 class="analysis-title">Scientific Analysis</h2>
            
            <div class="metric-grid">
                <div class="metric-card">
                    <div class="metric-value">15.2</div>
                    <div class="metric-label">Annual Average</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">4.8</div>
                    <div class="metric-label">Major/Year</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">±0.7</div>
                    <div class="metric-label">Uncertainty</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value">92%</div>
                    <div class="metric-label">Validation</div>
                </div>
            </div>
            
            <h3 style="color: var(--climada-primary); font-size: 16px; margin-bottom: 15px;">Recent Major Hurricanes</h3>
            <div class="hurricane-list">
                <div class="hurricane-item">
                    <div class="hurricane-name">Hurricane Ian (2022)</div>
                    <div class="hurricane-details">Category 4 • 150 mph • Florida landfall</div>
                </div>
                <div class="hurricane-item">
                    <div class="hurricane-name">Hurricane Ida (2021)</div>
                    <div class="hurricane-details">Category 4 • 150 mph • Louisiana landfall</div>
                </div>
                <div class="hurricane-item">
                    <div class="hurricane-name">Hurricane Laura (2020)</div>
                    <div class="hurricane-details">Category 4 • 150 mph • Louisiana/Texas</div>
                </div>
                <div class="hurricane-item">
                    <div class="hurricane-name">Hurricane Dorian (2019)</div>
                    <div class="hurricane-details">Category 5 • 185 mph • Bahamas</div>
                </div>
                <div class="hurricane-item">
                    <div class="hurricane-name">Hurricane Michael (2018)</div>
                    <div class="hurricane-details">Category 5 • 160 mph • Florida Panhandle</div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn btn-primary" onclick="exportData()">Export Data</button>
                <button class="btn btn-secondary" onclick="generateReport()">Generate Report</button>
            </div>
            
            <div class="methodology-info">
                <h4>Framework Advantages</h4>
                <p>• Peer-reviewed scientific methods<br>
                • Uncertainty quantification<br>
                • Global climate data integration<br>
                • Validated against observations</p>
            </div>
        </div>
    </main>

    <!-- Legend -->
    <div class="legend">
        <h4>Hurricane Categories</h4>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(100,100,100);"></div>
            <span>Tropical Storm (39-73 mph)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(255,255,0);"></div>
            <span>Category 1 (74-95 mph)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(255,200,0);"></div>
            <span>Category 2 (96-110 mph)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(255,140,0);"></div>
            <span>Category 3 (111-129 mph)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(255,69,0);"></div>
            <span>Category 4 (130-156 mph)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: rgb(139,0,0);"></div>
            <span>Category 5 (157+ mph)</span>
        </div>
    </div>

    <script>
        // Mapbox token
        mapboxgl.accessToken = 'pk.eyJ1IjoiamlhaGtuZWU1IiwiYSI6ImNtZTl3NzRvZjByNXgybnEydHNlc2R6ZHoifQ.8k33LovefbfNKcYWT-VkcA';
        
        // Initialize map
        const map = new mapboxgl.Map({
            container: 'climada-map',
            style: 'mapbox://styles/mapbox/dark-v11',
            center: [-85, 25],
            zoom: 5,
            pitch: 0
        });
        
        // Sample hurricane data
        const hurricaneData = {
            "type": "FeatureCollection",
            "features": [
                {
                    "type": "Feature",
                    "properties": {
                        "name": "Ian 2022",
                        "category": 4,
                        "year": 2022,
                        "max_wind": 150
                    },
                    "geometry": {
                        "type": "LineString",
                        "coordinates": [
                            [-83.0, 26.5], [-82.7, 26.8], [-82.4, 27.1], [-82.1, 27.4]
                        ]
                    }
                },
                {
                    "type": "Feature", 
                    "properties": {
                        "name": "Ida 2021",
                        "category": 4,
                        "year": 2021,
                        "max_wind": 150
                    },
                    "geometry": {
                        "type": "LineString",
                        "coordinates": [
                            [-90.2, 29.1], [-90.0, 29.4], [-89.8, 29.7], [-89.5, 30.0]
                        ]
                    }
                }
            ]
        };
        
        map.on('load', function() {
            // Add hurricane tracks
            map.addSource('hurricanes', {
                'type': 'geojson',
                'data': hurricaneData
            });
            
            map.addLayer({
                'id': 'hurricane-tracks',
                'type': 'line',
                'source': 'hurricanes',
                'layout': {
                    'line-join': 'round',
                    'line-cap': 'round'
                },
                'paint': {
                    'line-color': [
                        'case',
                        ['>=', ['get', 'category'], 4], '#8B0000',
                        ['>=', ['get', 'category'], 3], '#FF4500', 
                        ['>=', ['get', 'category'], 2], '#FF8C00',
                        ['>=', ['get', 'category'], 1], '#FFC800',
                        '#646464'
                    ],
                    'line-width': [
                        'case',
                        ['>=', ['get', 'category'], 4], 6,
                        ['>=', ['get', 'category'], 3], 5,
                        ['>=', ['get', 'category'], 2], 4,
                        3
                    ]
                }
            });
            
            // Add hurricane points
            map.addLayer({
                'id': 'hurricane-points',
                'type': 'circle',
                'source': 'hurricanes',
                'paint': {
                    'circle-radius': 6,
                    'circle-color': '#2196F3',
                    'circle-stroke-color': '#ffffff',
                    'circle-stroke-width': 2
                }
            });
        });
        
        // Event listeners
        document.getElementById('time-period').addEventListener('change', updateAnalysis);
        document.getElementById('category-filter').addEventListener('change', updateAnalysis);
        document.getElementById('analysis-type').addEventListener('change', updateAnalysis);
        
        function updateAnalysis() {
            const timePeriod = document.getElementById('time-period').value;
            const category = document.getElementById('category-filter').value;
            const analysisType = document.getElementById('analysis-type').value;
            
            // Update stats based on selections
            updateStats(timePeriod, category);
        }
        
        function updateStats(timePeriod, category) {
            // Simulate dynamic data updates
            const baseStorms = Math.floor(Math.random() * 50) + 100;
            const majors = Math.floor(baseStorms * 0.3);
            const avgCat = (Math.random() * 2 + 1.5).toFixed(1);
            const confidence = Math.floor(Math.random() * 20) + 80;
            
            document.getElementById('storms-count').textContent = baseStorms;
            document.getElementById('major-count').textContent = majors;
            document.getElementById('avg-intensity').textContent = `Cat ${avgCat}`;
            document.getElementById('confidence').textContent = `${confidence}%`;
        }
        
        function exportData() {
            alert('CLIMADA Framework: Exporting scientific dataset with uncertainty bounds...');
        }
        
        function generateReport() {
            alert('CLIMADA Framework: Generating peer-reviewed analysis report...');
        }
        
        // Initialize with default values
        updateAnalysis();
    </script>
</body>
</html>