<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Mapbox Test - Minimal</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.js"></script>
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.0.1/mapbox-gl.css" rel="stylesheet">
    <style>
        body { margin: 0; padding: 20px; }
        #map { 
            width: 800px; 
            height: 400px; 
            border: 2px solid red;
            background: yellow;
        }
        .debug {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>Mapbox Debug Test</h1>
    
    <div class="debug">
        <h3>Debug Info:</h3>
        <div id="debug-info">Loading...</div>
    </div>

    <div id="map"></div>
    
    <div class="debug">
        <h3>Console Output:</h3>
        <div id="console-output"></div>
    </div>

    <script>
        const debugDiv = document.getElementById('debug-info');
        const consoleDiv = document.getElementById('console-output');
        
        function log(message) {
            console.log(message);
            consoleDiv.innerHTML += '<div>' + message + '</div>';
        }
        
        function updateDebug(info) {
            debugDiv.innerHTML = info;
        }
        
        // Check if Mapbox is loaded
        updateDebug('Mapbox GL available: ' + (typeof mapboxgl !== 'undefined'));
        
        if (typeof mapboxgl === 'undefined') {
            log('ERROR: Mapbox GL JS not loaded');
        } else {
            log('✅ Mapbox GL JS loaded, version: ' + mapboxgl.version);
            
            // Set token
            mapboxgl.accessToken = 'pk.eyJ1IjoiamlhaGtuZWU1IiwiYSI6ImNtZTl3NzRvZjByNXgybnEydHNlc2R6ZHoifQ.8k33LovefbfNKcYWT-VkcA';
            log('✅ Token set');
            
            try {
                // Create map
                log('Creating map...');
                const map = new mapboxgl.Map({
                    container: 'map',
                    style: 'mapbox://styles/mapbox/streets-v12',
                    center: [-74.5, 40],
                    zoom: 9
                });
                
                log('✅ Map object created');
                
                map.on('load', () => {
                    log('🎉 Map loaded successfully!');
                    updateDebug('MAP WORKING! ✅');
                });
                
                map.on('error', (e) => {
                    log('❌ Map error: ' + JSON.stringify(e));
                    updateDebug('MAP ERROR: ' + e.error?.message);
                });
                
                // Add a simple marker
                map.on('load', () => {
                    new mapboxgl.Marker()
                        .setLngLat([-74.5, 40])
                        .addTo(map);
                    log('✅ Marker added');
                });
                
            } catch (error) {
                log('❌ Exception creating map: ' + error.message);
                updateDebug('EXCEPTION: ' + error.message);
            }
        }
        
        // Test container
        const container = document.getElementById('map');
        log('Container dimensions: ' + container.offsetWidth + 'x' + container.offsetHeight);
        
        // Wait and check again
        setTimeout(() => {
            log('Container dimensions after 2s: ' + container.offsetWidth + 'x' + container.offsetHeight);
        }, 2000);
    </script>
</body>
</html>